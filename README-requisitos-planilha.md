# Requisitos da Planilha Excel - Sistema de An√°lise de Turnover

## üìã **Colunas Obrigat√≥rias M√≠nimas**

Para funcionamento b√°sico, sua planilha **DEVE** conter estas 3 colunas:

| Coluna | Tipo | Descri√ß√£o | Valores Aceitos | Exemplo |
|--------|------|-----------|-----------------|---------|
| **`Mes`** | N√∫mero | M√™s do registro | 1 a 12 | `1`, `2`, `12` |
| **`Ano`** | N√∫mero | Ano do registro | 4 d√≠gitos | `2024`, `2025` |
| **`Status_2`** | Texto | Status do colaborador | Ver tabela abaixo | `Ativo`, `Desligado m√™s` |

### ‚ö†Ô∏è **Importante:**
- Os nomes das colunas s√£o **case-sensitive** (mai√∫sculas e min√∫sculas importam)
- Use exatamente: `Mes` (sem acento), `Ano`, `Status_2`

## üìä **Valores Aceitos para Status_2**

O sistema reconhece **APENAS** estes 4 status para calcular o turnover:

| Status | Descri√ß√£o | Quando Usar |
|--------|-----------|-------------|
| **`Ativo`** | Funcion√°rios ativos no final do m√™s | Colaboradores que estavam trabalhando no √∫ltimo dia do m√™s |
| **`Ativo m√™s`** | Funcion√°rios admitidos no m√™s | Colaboradores que foram contratados durante o m√™s |
| **`Desligado m√™s`** | Funcion√°rios demitidos no m√™s | Colaboradores que sa√≠ram da empresa durante o m√™s |
| **`Desligado`** | Funcion√°rios j√° demitidos | Colaboradores que j√° haviam sa√≠do em meses anteriores |

### üßÆ **F√≥rmula de C√°lculo do Turnover**
```
Turnover (%) = (("Ativo m√™s" + "Desligado m√™s") / 2) / Ativo √ó 100
```

## üéØ **Colunas Opcionais (Funcionalidades Avan√ßadas)**

### **Para Filtros por Entidade**
| Coluna | Tipo | Descri√ß√£o | Exemplo | Funcionalidade |
|--------|------|-----------|---------|----------------|
| `ENTIDADE` | Texto | Nome da entidade/unidade | `Matriz`, `Filial SP` | Filtro dropdown no topo |

### **Para An√°lises de Demiss√µes (Gr√°ficos Adicionais)**
| Coluna | Tipo | Descri√ß√£o | Exemplo | Gr√°ficos Habilitados |
|--------|------|-----------|---------|---------------------|
| `Status` | Texto | Status detalhado | `Demiss√£o`, `Desligamento` | Identifica demiss√µes autom√°tico |
| `Denomina√ß√£o de Cargo` | Texto | Cargo do colaborador | `Analista`, `Gerente` | TOP 10 cargos com mais demiss√µes |
| `Tempo de casa` | Texto | Tempo na empresa | `1 a 3 anos`, `5 a 10 anos` | Demiss√µes por tempo de empresa |
| `Range-Idade` | Texto | Faixa et√°ria | `25-30`, `31-40`, `41-50` | Demiss√µes por gera√ß√£o |
| `Tipo de desligamento` | Texto | Tipo da sa√≠da | `Demiss√£o sem justa causa` | Gr√°ficos de tipos |
| `Motivo desligamento` | Texto | Motivo da sa√≠da | `Pedido de demiss√£o` | An√°lise de motivos |

### **Para An√°lises Segmentadas (NOVO)**
| Coluna | Tipo | Descri√ß√£o | Valores Esperados | Funcionalidade |
|--------|------|-----------|-------------------|----------------|
| `Tipo de desligamento` | Texto | Quem iniciou | `Colaborador`, `Empresa` | **An√°lises separadas por tipo** |

## üé® **Funcionalidades por Conjunto de Colunas**

### **‚úÖ N√≠vel 1: B√°sico (`Mes`, `Ano`, `Status_2`)**
- C√°lculo de turnover mensal
- Gr√°fico de evolu√ß√£o do turnover por ano
- Estat√≠sticas anuais (TO acumulado, m√©dia de ativos)
- Tabela de dados detalhados por m√™s/ano

### **‚úÖ N√≠vel 2: + `ENTIDADE`**
- Filtro por entidade no topo da p√°gina
- An√°lises segmentadas por unidade/regional
- Estat√≠sticas filtradas por entidade

### **‚úÖ N√≠vel 3: + Colunas de Demografia**
- `Status` ‚Üí Identifica√ß√£o autom√°tica de demiss√µes
- `Denomina√ß√£o de Cargo` ‚Üí TOP 10 cargos com mais demiss√µes
- `Tempo de casa` ‚Üí An√°lise de reten√ß√£o por senioridade
- `Range-Idade` ‚Üí An√°lise demogr√°fica por gera√ß√£o
- `Tipo de desligamento` ‚Üí An√°lise de tipos de sa√≠da

### **üÜï N√≠vel 4: An√°lises Segmentadas (NOVO)**
Quando a coluna `Tipo de desligamento` cont√©m `"Colaborador"` ou `"Empresa"`:

**üìä Se√ß√£o "An√°lises Complementares":**

**Para Tipo "Colaborador":**
- Taxa de Desligamento Colaborador (linha temporal)
- TOP 10 Demiss√µes "Colaborador" por Cargo
- Tempo de Casa - Demiss√µes "Colaborador"
- Demiss√µes "Colaborador" por Gera√ß√£o
- Motivos de Desligamento - "Colaborador"

**Para Tipo "Empresa":**
- Taxa de Desligamento Empresa (linha temporal)
- TOP 10 Demiss√µes "Empresa" por Cargo
- Tempo de Casa - Demiss√µes "Empresa"
- Demiss√µes "Empresa" por Gera√ß√£o
- Motivos de Desligamento - "Empresa"

**F√≥rmulas das Taxas:**
```
Taxa Colaborador (%) = Desligados "Colaborador" / Total Ativos √ó 100
Taxa Empresa (%) = Desligados "Empresa" / Total Ativos √ó 100
```

## üìÅ **Exemplo de Planilha Completa**

```excel
| Mes | Ano  | Status_2       | ENTIDADE  | Status    | Denomina√ß√£o de Cargo | Tempo de casa | Range-Idade | Tipo de desligamento | Motivo desligamento |
|-----|------|----------------|-----------|-----------|---------------------|---------------|-------------|----------------------|---------------------|
| 1   | 2024 | Ativo          | Matriz    | Ativo     | Analista           | 1 a 3 anos    | 25-30       | -                    | -                   |
| 1   | 2024 | Ativo          | Matriz    | Ativo     | Gerente            | 5 a 10 anos   | 35-40       | -                    | -                   |
| 1   | 2024 | Ativo m√™s      | Filial SP | Ativo     | Assistente         | 0 a 1 ano     | 20-25       | -                    | -                   |
| 1   | 2024 | Desligado m√™s  | Matriz    | Demiss√£o  | Analista           | 2 a 5 anos    | 30-35       | Colaborador          | Pedido de demiss√£o  |
| 1   | 2024 | Desligado m√™s  | Filial SP | Demiss√£o  | Coordenador        | 3 a 5 anos    | 35-40       | Empresa              | Reestrutura√ß√£o      |
| 2   | 2024 | Ativo          | Matriz    | Ativo     | Gerente            | 5 a 10 anos   | 35-40       | -                    | -                   |
| 2   | 2024 | Ativo          | Filial SP | Ativo     | Assistente         | 0 a 1 ano     | 20-25       | -                    | -                   |
| 2   | 2024 | Desligado      | Matriz    | Demiss√£o  | Analista           | 2 a 5 anos    | 30-35       | Colaborador          | Pedido de demiss√£o  |
```

## üéØ **Dashboard Completo - Todas as Se√ß√µes**

### **üìà Se√ß√£o Principal**
1. **KPIs Anuais** - TO acumulado e m√©dia de ativos por ano
2. **Evolu√ß√£o do Turnover** - Linha temporal mensal
3. **Demiss√µes por Cargo** - TOP 10 cargos 
4. **Demiss√µes por Tempo de Casa** - Distribui√ß√£o por senioridade
5. **Demiss√µes por Gera√ß√£o** - Distribui√ß√£o por faixa et√°ria
6. **Tipos de Desligamento** - Distribui√ß√£o geral
7. **Dados Detalhados** - Tabela com totais mensais

### **üîç Se√ß√£o "An√°lises Complementares" (Novo)**
8. **Dados - Taxa Colaborador** - Base de c√°lculo
9. **Taxa de Desligamento - Colaborador** - Evolu√ß√£o temporal
10. **TOP 10 Demiss√µes "Colaborador" por Cargo**
11. **Tempo de Casa - Demiss√µes "Colaborador"**
12. **Demiss√µes "Colaborador" por Gera√ß√£o**
13. **Motivos - "Colaborador"**
14. **Dados - Taxa Empresa** - Base de c√°lculo
15. **Taxa de Desligamento - Empresa** - Evolu√ß√£o temporal
16. **TOP 10 Demiss√µes "Empresa" por Cargo**
17. **Tempo de Casa - Demiss√µes "Empresa"**
18. **Demiss√µes "Empresa" por Gera√ß√£o**
19. **Motivos - "Empresa"**

## ‚ö†Ô∏è **Valida√ß√µes e Erros Comuns**

### **Erro: "Colunas necess√°rias n√£o encontradas"**
**Causa:** Faltam as colunas obrigat√≥rias  
**Solu√ß√£o:** Certifique-se que sua planilha tem `Mes`, `Ano` e `Status_2`

### **Erro: "Nenhum dado v√°lido encontrado"**
**Causa:** Status_2 com valores n√£o reconhecidos  
**Solu√ß√£o:** Use apenas: `Ativo`, `Ativo m√™s`, `Desligado m√™s`, `Desligado`

### **Gr√°ficos n√£o aparecem**
**Causa:** Coluna correspondente n√£o existe ou est√° vazia  
**Solu√ß√£o:** Verifique se as colunas opcionais est√£o preenchidas corretamente

### **An√°lises Complementares n√£o aparecem**
**Causa:** Coluna `Tipo de desligamento` n√£o cont√©m "Colaborador" ou "Empresa"  
**Solu√ß√£o:** Preencha com exatamente esses termos (case-insensitive)

## üìã **Template Recomendado**

Baixe este template e preencha com seus dados:

```excel
Mes | Ano | Status_2 | ENTIDADE | Status | Denomina√ß√£o de Cargo | Tempo de casa | Range-Idade | Tipo de desligamento | Motivo desligamento
----|-----|----------|----------|--------|---------------------|---------------|-------------|----------------------|--------------------
1   | 2024| Ativo    | Matriz   | Ativo  | Analista           | 1 a 3 anos    | 25-30       | -                    | -
1   | 2024| Ativo m√™s | Filial   | Ativo  | Assistente         | 0 a 1 ano     | 20-25       | -                    | -
1   | 2024| Desligado m√™s | Matriz | Demiss√£o | Coordenador    | 2 a 5 anos    | 30-35       | Colaborador          | Pedido de demiss√£o
```

## üö® **Checklist Final**

Antes de fazer upload, confirme:

- [ ] ‚úÖ Arquivo est√° em formato `.xlsx`
- [ ] ‚úÖ Primeira linha cont√©m cabe√ßalhos
- [ ] ‚úÖ Colunas `Mes`, `Ano`, `Status_2` est√£o presentes
- [ ] ‚úÖ Nomes das colunas est√£o corretos (sem acentos, case-sensitive)
- [ ] ‚úÖ Status_2 cont√©m apenas: `Ativo`, `Ativo m√™s`, `Desligado m√™s`, `Desligado`
- [ ] ‚úÖ Dados de Mes s√£o n√∫meros 1-12
- [ ] ‚úÖ Dados de Ano s√£o n√∫meros (ex: 2024)
- [ ] ‚úÖ N√£o h√° linhas completamente vazias no meio dos dados
- [ ] ‚úÖ Para an√°lises avan√ßadas: colunas opcionais preenchidas
- [ ] ‚úÖ Para an√°lises segmentadas: `Tipo de desligamento` com "Colaborador"/"Empresa"

## üí° **Dicas para Melhores Resultados**

### **üìä Para Gr√°ficos Mais Ricos**
1. **Padronize nomes** de cargos e entidades (evite varia√ß√µes)
2. **Use categorias consistentes** para tempo de casa (ex: "0 a 1 ano", "1 a 3 anos")
3. **Mantenha faixas et√°rias uniformes** (ex: "25-30", "31-40")
4. **Seja espec√≠fico nos motivos** de desligamento para melhor an√°lise

### **üéØ Para An√°lises Segmentadas**
5. **Use exatamente "Colaborador" e "Empresa"** na coluna Tipo de desligamento
6. **Preencha motivos detalhados** para an√°lises mais precisas
7. **Mantenha consist√™ncia temporal** para compara√ß√µes v√°lidas

### **üîç Para Troubleshooting**
8. **Teste com dados pequenos** primeiro
9. **Verifique console do navegador** para erros
10. **Use filtro por entidade** para debugar dados espec√≠ficos

## üìû **D√∫vidas Frequentes**

**P: Posso ter outras colunas al√©m das listadas?**  
R: **Sim!** O sistema ignora colunas extras. Apenas as listadas s√£o utilizadas.

**P: A ordem das colunas importa?**  
R: **N√£o.** As colunas podem estar em qualquer ordem.

**P: Como sei se as an√°lises segmentadas v√£o funcionar?**  
R: **Verifique se** a coluna `Tipo de desligamento` cont√©m pelo menos alguns registros com "Colaborador" ou "Empresa".

**P: Por que alguns gr√°ficos n√£o aparecem?**  
R: **Cada gr√°fico requer** colunas espec√≠ficas. Se a coluna n√£o existir ou estiver vazia, o gr√°fico mostra "Nenhum dado dispon√≠vel".

**P: Posso misturar dados de diferentes empresas?**  
R: **Sim!** Use a coluna `ENTIDADE` para separar e filtre conforme necess√°rio.

**P: O sistema funciona com dados hist√≥ricos de v√°rios anos?**  
R: **Perfeitamente!** O sistema agrupa automaticamente por ano e permite compara√ß√µes temporais.

## üèÜ **Resultado Final**

Com todas as colunas preenchidas corretamente, voc√™ ter√°:

‚úÖ **19 visualiza√ß√µes diferentes** de an√°lise de turnover  
‚úÖ **Dashboards interativos** com drill-down  
‚úÖ **Filtros din√¢micos** por entidade  
‚úÖ **An√°lises segmentadas** por tipo de desligamento  
‚úÖ **Exporta√ß√£o de gr√°ficos** em alta qualidade  
‚úÖ **Compara√ß√µes temporais** autom√°ticas  
‚úÖ **KPIs executivos** para apresenta√ß√µes
